<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React Hooks - Blog</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="blog-style.css">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>
<body>
    <!-- Back Navigation -->
    <div class="back-navigation">
        <a href="../index.html#blog" class="back-btn">
            <i class="ph ph-arrow-left"></i>
        </a>
    </div>

    <div class="blog-content">
        
        <h1>React Hooks - useState và useEffect</h1>
        
        <p>React Hooks cho phép sử dụng state và lifecycle features trong function components. Hãy cùng tìm hiểu 2 hooks phổ biến nhất!</p>
        
        <h2>1. useState - Quản lý State</h2>
        <p>Hook để thêm state vào function component:</p>
        
        <pre><code>import React, { useState } from 'react';

function Counter() {
    // Khai báo state variable
    const [count, setCount] = useState(0);
    
    return (
        &lt;div&gt;
            &lt;p&gt;Bạn đã click {count} lần&lt;/p&gt;
            &lt;button onClick={() => setCount(count + 1)}&gt;
                Click me
            &lt;/button&gt;
        &lt;/div&gt;
    );
}

// Multiple state variables
function UserForm() {
    const [name, setName] = useState('');
    const [email, setEmail] = useState('');
    const [age, setAge] = useState(0);
    
    return (
        &lt;form&gt;
            &lt;input 
                value={name}
                onChange={(e) => setName(e.target.value)}
            /&gt;
            &lt;input 
                value={email}
                onChange={(e) => setEmail(e.target.value)}
            /&gt;
        &lt;/form&gt;
    );
}</code></pre>
        
        <h2>2. useState với Objects và Arrays</h2>
        <p>Cần spread operator để update state object/array:</p>
        
        <pre><code>function UserProfile() {
    const [user, setUser] = useState({
        name: 'Huy',
        age: 22,
        city: 'Hanoi'
    });
    
    // Update object - phải spread
    const updateName = (newName) => {
        setUser({
            ...user,
            name: newName
        });
    };
    
    // Hoặc dùng functional update
    const incrementAge = () => {
        setUser(prevUser => ({
            ...prevUser,
            age: prevUser.age + 1
        }));
    };
}

function TodoList() {
    const [todos, setTodos] = useState([]);
    
    // Thêm item
    const addTodo = (text) => {
        setTodos([...todos, { id: Date.now(), text }]);
    };
    
    // Xóa item
    const removeTodo = (id) => {
        setTodos(todos.filter(todo => todo.id !== id));
    };
}</code></pre>
        
        <h2>3. useEffect - Side Effects</h2>
        <p>Hook để xử lý side effects (API calls, subscriptions, DOM manipulation):</p>
        
        <pre><code>import React, { useState, useEffect } from 'react';

function UserData() {
    const [user, setUser] = useState(null);
    
    // Chạy sau mỗi render
    useEffect(() => {
        console.log('Component rendered');
    });
    
    // Chạy chỉ 1 lần khi mount ([] dependency)
    useEffect(() => {
        fetch('https://api.example.com/user')
            .then(res => res.json())
            .then(data => setUser(data));
    }, []); // Empty array = chỉ chạy lần đầu
    
    // Chạy khi user thay đổi
    useEffect(() => {
        console.log('User changed:', user);
    }, [user]); // Dependency array
    
    return &lt;div&gt;{user?.name}&lt;/div&gt;;
}</code></pre>
        
        <h2>4. Cleanup Function</h2>
        <p>Return function trong useEffect để cleanup:</p>
        
        <pre><code>function Timer() {
    const [seconds, setSeconds] = useState(0);
    
    useEffect(() => {
        // Setup
        const interval = setInterval(() => {
            setSeconds(s => s + 1);
        }, 1000);
        
        // Cleanup function
        return () => {
            clearInterval(interval);
        };
    }, []); // Chỉ setup/cleanup khi mount/unmount
    
    return &lt;div&gt;{seconds} seconds&lt;/div&gt;;
}

function WindowSize() {
    const [width, setWidth] = useState(window.innerWidth);
    
    useEffect(() => {
        const handleResize = () => setWidth(window.innerWidth);
        
        window.addEventListener('resize', handleResize);
        
        // Cleanup: remove listener khi unmount
        return () => {
            window.removeEventListener('resize', handleResize);
        };
    }, []);
}</code></pre>
        
        <h2>5. Fetch Data Pattern</h2>
        <p>Pattern phổ biến để fetch data:</p>
        
        <pre><code>function DataFetcher() {
    const [data, setData] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    
    useEffect(() => {
        const fetchData = async () => {
            try {
                setLoading(true);
                const response = await fetch('https://api.example.com/data');
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                const result = await response.json();
                setData(result);
                setError(null);
            } catch (err) {
                setError(err.message);
                setData(null);
            } finally {
                setLoading(false);
            }
        };
        
        fetchData();
    }, []);
    
    if (loading) return &lt;div&gt;Loading...&lt;/div&gt;;
    if (error) return &lt;div&gt;Error: {error}&lt;/div&gt;;
    if (!data) return null;
    
    return &lt;div&gt;{/* Render data */}&lt;/div&gt;;
}</code></pre>
        
        <h2>6. Common Mistakes</h2>
        <ul>
            <li><strong>Quên dependency array:</strong> Gây infinite loop</li>
            <li><strong>Missing dependencies:</strong> Stale closure problem</li>
            <li><strong>Async trong useEffect:</strong> Không được return Promise trực tiếp</li>
        </ul>
        
        <pre><code>// ❌ SAI - Infinite loop
useEffect(() => {
    setCount(count + 1);
}); // Không có dependency array

// ❌ SAI - Async function trực tiếp
useEffect(async () => {
    const data = await fetchData();
}, []);

// ✅ ĐÚNG - Async bên trong
useEffect(() => {
    const loadData = async () => {
        const data = await fetchData();
        setData(data);
    };
    loadData();
}, []);</code></pre>
        
        <h2>Kết luận</h2>
        <p>useState và useEffect là 2 hooks cơ bản nhất trong React:</p>
        <ul>
            <li><strong>useState:</strong> Quản lý state trong component</li>
            <li><strong>useEffect:</strong> Xử lý side effects</li>
            <li>Luôn chú ý dependency array để tránh bugs</li>
            <li>Cleanup khi cần (timers, subscriptions, listeners)</li>
        </ul>
        <p>Thành thạo 2 hooks này là nền tảng để học các hooks khác!</p>
    </div>

    <!-- Scroll to Top Button -->
    <button id="scrollToTop" class="scroll-to-top" onclick="scrollToTop()">
        <i class="ph ph-arrow-up"></i>
    </button>

    <script>
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        window.addEventListener('scroll', function() {
            const scrollBtn = document.getElementById('scrollToTop');
            if (window.scrollY > 300) {
                scrollBtn.classList.add('visible');
            } else {
                scrollBtn.classList.remove('visible');
            }
        });
    </script>
</body>
</html>

